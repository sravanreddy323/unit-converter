<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Unit Converter Ultimate</title>
    
    <!-- LIBRARIES -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* === THEME VARIABLES === */
        :root {
            /* LIGHT (Default) */
            --bg-app: #f1f5f9;
            --bg-card: #ffffff;
            --bg-input: #f8fafc;
            --text-main: #0f172a;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --primary: #4f46e5;
            --primary-light: #eef2ff;
            
            /* Calc Light */
            --btn-bg: #ffffff;
            --btn-text: #1e293b;
            --btn-op-bg: #e0e7ff;
            --btn-op-text: #4338ca;
            --btn-ac-bg: #fee2e2;
            --btn-ac-text: #ef4444;
        }

        [data-theme="dark"] {
            /* PITCH BLACK DARK MODE */
            --bg-app: #000000;
            --bg-card: #121212;
            --bg-input: #1e1e1e;
            --text-main: #ffffff;
            --text-muted: #a1a1aa;
            --border: #27272a;
            --primary: #818cf8;
            --primary-light: #1e1b4b;

            /* Calc Dark */
            --btn-bg: #1e1e1e;
            --btn-text: #ffffff;
            --btn-op-bg: #312e81;
            --btn-op-text: #c7d2fe;
            --btn-ac-bg: #450a0a;
            --btn-ac-text: #fca5a5;
        }

        /* === RESET & LAYOUT === */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; touch-action: manipulation; }
        
        html, body {
            margin: 0; padding: 0;
            background-color: var(--bg-app);
            color: var(--text-main);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            width: 100%; height: 100%; 
            overflow: hidden; position: fixed; 
            transition: background-color 0.3s, color 0.3s;
        }

        body { display: flex; flex-direction: column; }

        /* === COMPONENTS === */
        .app-header {
            flex: none; height: 60px;
            background-color: var(--bg-card);
            border-bottom: 1px solid var(--border);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 16px; padding-top: env(safe-area-inset-top);
            z-index: 50;
        }

        .app-content {
            flex: 1; width: 100%; position: relative;
            overflow-y: auto; overflow-x: hidden;
            padding: 16px;
            /* Extra padding at bottom for content scrolling */
            padding-bottom: calc(80px + env(safe-area-inset-bottom));
        }

        .tab-content { display: none; width: 100%; }
        .tab-content.active { display: block; animation: fadeIn 0.2s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* Calculator Specific: Full Height Overlay */
        #tab-calc.active {
            display: flex; flex-direction: column;
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            padding: 0; margin: 0;
            height: 100%;
            background-color: var(--bg-app);
            z-index: 10;
        }

        .app-footer {
            flex: none; 
            min-height: 70px;
            background-color: var(--bg-card);
            border-top: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 4px; padding-bottom: env(safe-area-inset-bottom);
            z-index: 50;
        }

        /* === INPUT STYLING (FIXED ALIGNMENT) === */
        .input-card { margin-bottom: 12px; position: relative; }
        
        .input-label {
            display: block; font-size: 11px; font-weight: 700;
            color: var(--text-muted); text-transform: uppercase;
            margin-bottom: 6px; margin-left: 4px;
        }

        .input-field {
            width: 100%;
            background-color: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 12px 16px;
            /* Right padding prevents overlap with unit symbol */
            padding-right: 50px; 
            font-size: 18px; font-weight: 600;
            color: var(--text-main);
            transition: all 0.2s;
            height: 52px;
        }
        .input-field:focus { border-color: var(--primary); box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2); }

        .unit-symbol {
            position: absolute; right: 16px; top: 38px;
            font-size: 13px; font-weight: 700; color: var(--text-muted);
            pointer-events: none;
        }

        .split-card {
            background-color: var(--primary-light);
            border: 1px solid var(--primary);
            padding: 12px; border-radius: 16px; margin-bottom: 16px;
        }
        .split-input {
            background-color: var(--bg-card);
            border: 1px solid var(--primary);
            color: var(--primary); text-align: center;
            padding-right: 40px;
        }
        .split-symbol {
            position: absolute; right: 12px; top: 14px;
            font-size: 11px; font-weight: 800; color: var(--primary); opacity: 0.7;
            pointer-events: none;
        }

        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }

        /* === CALCULATOR STYLES === */
        .calc-wrapper {
            flex: 1; display: flex; flex-direction: column;
            padding: 10px; padding-bottom: 0;
        }
        
        .calc-display-container {
            background-color: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 16px; margin-bottom: 10px;
            text-align: right;
            height: 25%; min-height: 120px;
            display: flex; flex-direction: column; justify-content: flex-end;
        }
        
        #calc-hist { 
            font-family: monospace; color: var(--text-muted); font-size: 18px; height: 28px; 
            overflow-x: auto; white-space: nowrap; margin-bottom: 4px;
        }
        #calc-res { 
            background: transparent; border: none; width: 100%;
            font-size: 48px; font-weight: 700; color: var(--text-main);
            text-align: right; padding: 0; margin: 0;
        }

        /* STRICT GRID LAYOUT */
        .calc-pad {
            flex: 1;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 10px;
            padding-bottom: 10px;
        }

        .btn {
            border-radius: 14px; font-size: 26px; font-weight: 500;
            display: flex; align-items: center; justify-content: center;
            transition: transform 0.1s, opacity 0.2s;
            cursor: pointer; border: 1px solid var(--border);
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            width: 100%; height: 100%;
        }
        .btn:active { transform: scale(0.95); opacity: 0.8; }

        .btn-zero { grid-column: span 2; }

        .b-num { background-color: var(--btn-bg); color: var(--btn-text); }
        .b-op { background-color: var(--btn-op-bg); color: var(--btn-op-text); border-color: var(--btn-op-bg); font-weight: 600; }
        .b-ac { background-color: var(--btn-ac-bg); color: var(--btn-ac-text); border-color: var(--btn-ac-bg); font-weight: 600; }
        .b-eq { background-color: var(--primary); color: #fff; border: none; font-weight: 600; }

        /* === NAVIGATION === */
        .nav-btn {
            flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100%; background: transparent; border: none; cursor: pointer;
            color: var(--text-muted); transition: color 0.2s;
        }
        .nav-btn.active { color: var(--primary); }
        .nav-icon { font-size: 20px; margin-bottom: 3px; }
        .nav-txt { font-size: 10px; font-weight: 700; letter-spacing: 0.5px; }

    </style>
</head>
<body>

    <!-- Header -->
    <header class="app-header">
        <div class="flex items-center gap-2">
            <i class="fa-solid fa-shapes text-indigo-500"></i>
            <span class="font-bold text-lg">Unit Converter</span>
        </div>
        <div class="flex items-center gap-3">
            <button onclick="toggleTheme()" class="w-9 h-9 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center border border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-300 transition active:scale-90">
                <i id="theme-icon" class="fa-solid fa-moon"></i>
            </button>
            <button onclick="resetAll()" class="text-xs font-bold bg-indigo-600 px-3 py-1.5 rounded-lg text-white shadow-sm active:scale-95 transition">RESET</button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="app-content relative">

        <!-- LENGTH TAB -->
        <div id="tab-length" class="tab-content active">
            <div class="input-card">
                <label class="input-label">Meters (Base)</label>
                <input type="number" id="len_m" oninput="cLen('m')" class="input-field" placeholder="0">
                <span class="unit-symbol">m</span>
            </div>
            
            <div class="grid grid-cols-2 gap-3 mb-4">
                <div class="input-card">
                    <label class="input-label">Feet</label>
                    <input type="number" id="len_ft" oninput="cLen('ft')" class="input-field" placeholder="0">
                    <span class="unit-symbol">ft</span>
                </div>
                <div class="input-card">
                    <label class="input-label">Inches</label>
                    <input type="number" id="len_in" oninput="cLen('in')" class="input-field" placeholder="0">
                    <span class="unit-symbol">in</span>
                </div>
            </div>

            <!-- Split Height -->
            <div class="split-card">
                <label class="block text-[11px] font-bold text-indigo-600 uppercase tracking-wider mb-2">Height (Split)</label>
                <div class="grid grid-cols-2 gap-3">
                    <div class="relative">
                        <input type="number" id="len_s_ft" oninput="cLen('s')" class="input-field split-input" placeholder="0">
                        <span class="split-symbol">FT</span>
                    </div>
                    <div class="relative">
                        <input type="number" id="len_s_in" oninput="cLen('s')" class="input-field split-input" placeholder="0">
                        <span class="split-symbol">IN</span>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-3">
                <div class="input-card"><label class="input-label">Kilometers</label><input type="number" id="len_km" oninput="cLen('km')" class="input-field" placeholder="0"><span class="unit-symbol">km</span></div>
                <div class="input-card"><label class="input-label">Miles</label><input type="number" id="len_mi" oninput="cLen('mi')" class="input-field" placeholder="0"><span class="unit-symbol">mi</span></div>
                <div class="input-card"><label class="input-label">Yards</label><input type="number" id="len_yd" oninput="cLen('yd')" class="input-field" placeholder="0"><span class="unit-symbol">yd</span></div>
                <div class="input-card"><label class="input-label">Centimeters</label><input type="number" id="len_cm" oninput="cLen('cm')" class="input-field" placeholder="0"><span class="unit-symbol">cm</span></div>
            </div>
        </div>

        <!-- AREA TAB -->
        <div id="tab-area" class="tab-content">
            <div class="input-card">
                <label class="input-label">Square Meters</label>
                <input type="number" id="area_m" oninput="cArea('m')" class="input-field" placeholder="0">
                <span class="unit-symbol">m²</span>
            </div>
            <div class="grid grid-cols-2 gap-3">
                <div class="input-card"><label class="input-label">Sq Feet</label><input type="number" id="area_ft" oninput="cArea('ft')" class="input-field" placeholder="0"><span class="unit-symbol">ft²</span></div>
                <div class="input-card"><label class="input-label">Sq Yards</label><input type="number" id="area_yd" oninput="cArea('yd')" class="input-field" placeholder="0"><span class="unit-symbol">yd²</span></div>
                <div class="input-card"><label class="input-label">Cents</label><input type="number" id="area_ct" oninput="cArea('ct')" class="input-field" placeholder="0"><span class="unit-symbol">ct</span></div>
                <div class="input-card"><label class="input-label">Acres</label><input type="number" id="area_ac" oninput="cArea('ac')" class="input-field" placeholder="0"><span class="unit-symbol">ac</span></div>
                <div class="input-card"><label class="input-label">Hectares</label><input type="number" id="area_ha" oninput="cArea('ha')" class="input-field" placeholder="0"><span class="unit-symbol">ha</span></div>
                <div class="input-card"><label class="input-label">Sq KM</label><input type="number" id="area_km" oninput="cArea('km')" class="input-field" placeholder="0"><span class="unit-symbol">km²</span></div>
            </div>
        </div>

        <!-- VOLUME TAB -->
        <div id="tab-volume" class="tab-content">
            <div class="grid grid-cols-2 gap-3">
                <div class="input-card"><label class="input-label text-blue-500">Liters</label><input type="number" id="vol_l" oninput="cVol('l')" class="input-field" placeholder="0"><span class="unit-symbol">L</span></div>
                <div class="input-card"><label class="input-label">Milliliters</label><input type="number" id="vol_ml" oninput="cVol('ml')" class="input-field" placeholder="0"><span class="unit-symbol">ml</span></div>
                <div class="input-card"><label class="input-label">Gallons</label><input type="number" id="vol_gal" oninput="cVol('gal')" class="input-field" placeholder="0"><span class="unit-symbol">gal</span></div>
                <div class="input-card"><label class="input-label">Cups</label><input type="number" id="vol_cup" oninput="cVol('cup')" class="input-field" placeholder="0"><span class="unit-symbol">cp</span></div>
                <div class="input-card"><label class="input-label">Cubic M</label><input type="number" id="vol_m" oninput="cVol('m')" class="input-field" placeholder="0"><span class="unit-symbol">m³</span></div>
                <div class="input-card"><label class="input-label">Cubic Ft</label><input type="number" id="vol_ft" oninput="cVol('ft')" class="input-field" placeholder="0"><span class="unit-symbol">ft³</span></div>
            </div>
        </div>

        <!-- WEIGHT TAB -->
        <div id="tab-weight" class="tab-content">
            <div class="input-card">
                <label class="input-label text-orange-500">Kilograms</label>
                <input type="number" id="w_kg" oninput="cWei('kg')" class="input-field" placeholder="0">
                <span class="unit-symbol">kg</span>
            </div>
            <div class="grid grid-cols-2 gap-3">
                <div class="input-card"><label class="input-label">Pounds</label><input type="number" id="w_lb" oninput="cWei('lb')" class="input-field" placeholder="0"><span class="unit-symbol">lb</span></div>
                <div class="input-card"><label class="input-label">Grams</label><input type="number" id="w_g" oninput="cWei('g')" class="input-field" placeholder="0"><span class="unit-symbol">g</span></div>
                <div class="input-card"><label class="input-label">Ounces</label><input type="number" id="w_oz" oninput="cWei('oz')" class="input-field" placeholder="0"><span class="unit-symbol">oz</span></div>
                <div class="input-card"><label class="input-label">Tons</label><input type="number" id="w_t" oninput="cWei('t')" class="input-field" placeholder="0"><span class="unit-symbol">t</span></div>
            </div>
        </div>

        <!-- CALCULATOR TAB -->
        <div id="tab-calc" class="tab-content">
            <div class="calc-wrapper">
                <div class="calc-display-container">
                    <div id="calc-hist"></div>
                    <input type="text" id="calc-res" readonly value="0">
                </div>
                <div class="calc-pad">
                    <button class="btn b-ac" onclick="calc('AC')">AC</button>
                    <button class="btn b-ac" onclick="calc('DEL')"><i class="fa-solid fa-delete-left"></i></button>
                    <button class="btn b-op" onclick="calc('%')">%</button>
                    <button class="btn b-op" onclick="calc('/')">÷</button>

                    <button class="btn b-num" onclick="calc('7')">7</button>
                    <button class="btn b-num" onclick="calc('8')">8</button>
                    <button class="btn b-num" onclick="calc('9')">9</button>
                    <button class="btn b-op" onclick="calc('*')">×</button>

                    <button class="btn b-num" onclick="calc('4')">4</button>
                    <button class="btn b-num" onclick="calc('5')">5</button>
                    <button class="btn b-num" onclick="calc('6')">6</button>
                    <button class="btn b-op" onclick="calc('-')">-</button>

                    <button class="btn b-num" onclick="calc('1')">1</button>
                    <button class="btn b-num" onclick="calc('2')">2</button>
                    <button class="btn b-num" onclick="calc('3')">3</button>
                    <button class="btn b-op" onclick="calc('+')">+</button>

                    <button class="btn b-num btn-zero" onclick="calc('0')">0</button>
                    <button class="btn b-num" onclick="calc('.')">.</button>
                    <button class="btn b-eq" onclick="calc('=')">=</button>
                </div>
            </div>
        </div>

        <!-- BASIC TAB -->
        <div id="tab-basic" class="tab-content">
            <div class="grid grid-cols-3 gap-3 mb-4">
                <div class="input-card"><label class="input-label text-red-500">Celcius</label><input type="number" id="b_c" oninput="cTem('c')" class="input-field text-center" placeholder="0"></div>
                <div class="input-card"><label class="input-label">Fahren</label><input type="number" id="b_f" oninput="cTem('f')" class="input-field text-center" placeholder="0"></div>
                <div class="input-card"><label class="input-label">Kelvin</label><input type="number" id="b_k" oninput="cTem('k')" class="input-field text-center" placeholder="0"></div>
            </div>
            <div class="grid grid-cols-2 gap-3">
                <div class="input-card"><label class="input-label">KM/H</label><input type="number" id="b_km" oninput="cSpd('km')" class="input-field" placeholder="0"><span class="unit-symbol">km</span></div>
                <div class="input-card"><label class="input-label">MPH</label><input type="number" id="b_mi" oninput="cSpd('mi')" class="input-field" placeholder="0"><span class="unit-symbol">mi</span></div>
            </div>
        </div>

    </main>

    <!-- Footer Nav -->
    <footer class="app-footer">
        <button onclick="tab('length', this)" class="nav-btn active">
            <i class="fa-solid fa-ruler nav-icon"></i><span class="nav-txt">LEN</span>
        </button>
        <button onclick="tab('area', this)" class="nav-btn">
            <i class="fa-solid fa-vector-square nav-icon"></i><span class="nav-txt">AREA</span>
        </button>
        <button onclick="tab('volume', this)" class="nav-btn">
            <i class="fa-solid fa-cube nav-icon"></i><span class="nav-txt">VOL</span>
        </button>
        <button onclick="tab('weight', this)" class="nav-btn">
            <i class="fa-solid fa-weight-scale nav-icon"></i><span class="nav-txt">WGT</span>
        </button>
        <button onclick="tab('calc', this)" class="nav-btn">
            <i class="fa-solid fa-calculator nav-icon"></i><span class="nav-txt">CALC</span>
        </button>
        <button onclick="tab('basic', this)" class="nav-btn">
            <i class="fa-solid fa-bars nav-icon"></i><span class="nav-txt">ETC</span>
        </button>
    </footer>

    <script>
        // HAPTICS
        function vib() { if(navigator.vibrate) navigator.vibrate(8); }

        // THEME
        function toggleTheme() {
            vib();
            const body = document.body;
            const icon = document.getElementById('theme-icon');
            if (body.getAttribute('data-theme') === 'dark') {
                body.removeAttribute('data-theme');
                icon.classList.remove('fa-sun'); icon.classList.add('fa-moon');
                localStorage.setItem('theme', 'light');
            } else {
                body.setAttribute('data-theme', 'dark');
                icon.classList.remove('fa-moon'); icon.classList.add('fa-sun');
                localStorage.setItem('theme', 'dark');
            }
        }
        if(localStorage.getItem('theme') === 'dark') toggleTheme();

        // TABS
        function tab(id, btn) {
            vib();
            document.querySelectorAll(".tab-content").forEach(e => e.classList.remove("active"));
            document.getElementById("tab-" + id).classList.add("active");
            
            document.querySelectorAll(".nav-btn").forEach(e => e.classList.remove("active"));
            btn.classList.add("active");
        }

        function resetAll() {
            vib();
            document.querySelectorAll("input").forEach(i => i.value = "");
            calc('AC'); 
        }

        function fmt(n) { if(!n && n!==0) return ""; return parseFloat(n.toFixed(5)); }

        // CONVERTERS
        function cLen(s) {
            let m=0, e={m:get('len_m'), ft:get('len_ft'), in:get('len_in'), km:get('len_km'), mi:get('len_mi'), yd:get('len_yd'), cm:get('len_cm'), sf:get('len_s_ft'), si:get('len_s_in')};
            if(s=='m') m=parseFloat(e.m.value);
            else if(s=='ft') m=parseFloat(e.ft.value)/3.28084;
            else if(s=='in') m=parseFloat(e.in.value)/39.3701;
            else if(s=='km') m=parseFloat(e.km.value)*1000;
            else if(s=='mi') m=parseFloat(e.mi.value)*1609.34;
            else if(s=='yd') m=parseFloat(e.yd.value)/1.09361;
            else if(s=='cm') m=parseFloat(e.cm.value)/100;
            else if(s=='s') m=(parseFloat(e.sf.value||0)/3.28084)+(parseFloat(e.si.value||0)/39.3701);

            if(!isNaN(m)){
                if(s!='m') e.m.value=fmt(m);
                if(s!='ft') e.ft.value=fmt(m*3.28084);
                if(s!='in') e.in.value=fmt(m*39.3701);
                if(s!='km') e.km.value=fmt(m/1000);
                if(s!='mi') e.mi.value=fmt(m/1609.34);
                if(s!='yd') e.yd.value=fmt(m*1.09361);
                if(s!='cm') e.cm.value=fmt(m*100);
                if(s!='s'){ let t=m*39.3701; e.sf.value=Math.floor(t/12); e.si.value=fmt(t%12); }
            }
        }

        function cArea(s) {
            let m=0, e={m:get('area_m'), ft:get('area_ft'), yd:get('area_yd'), ct:get('area_ct'), ac:get('area_ac'), ha:get('area_ha'), km:get('area_km'), mi:get('area_mi')};
            if(s=='m') m=parseFloat(e.m.value);
            else if(s=='ft') m=parseFloat(e.ft.value)/10.7639;
            else if(s=='yd') m=parseFloat(e.yd.value)/1.19599;
            else if(s=='ct') m=parseFloat(e.ct.value)*40.4686;
            else if(s=='ac') m=parseFloat(e.ac.value)*4046.86;
            else if(s=='ha') m=parseFloat(e.ha.value)*10000;
            else if(s=='km') m=parseFloat(e.km.value)*1000000;
            else if(s=='mi') m=parseFloat(e.mi.value)*2589988;

            if(!isNaN(m)){
                if(s!='m') e.m.value=fmt(m);
                if(s!='ft') e.ft.value=fmt(m*10.7639);
                if(s!='yd') e.yd.value=fmt(m*1.19599);
                if(s!='ct') e.ct.value=fmt(m/40.4686);
                if(s!='ac') e.ac.value=fmt(m/4046.86);
                if(s!='ha') e.ha.value=fmt(m/10000);
                if(s!='km') e.km.value=fmt(m/1000000);
                if(s!='mi') e.mi.value=fmt(m/2589988);
            }
        }

        function cVol(s) {
            let l=0, e={l:get('vol_l'), ml:get('vol_ml'), gal:get('vol_gal'), cp:get('vol_cup'), m:get('vol_m'), ft:get('vol_ft')};
            if(s=='l') l=parseFloat(e.l.value);
            else if(s=='ml') l=parseFloat(e.ml.value)/1000;
            else if(s=='gal') l=parseFloat(e.gal.value)*3.78541;
            else if(s=='cp') l=parseFloat(e.cp.value)*0.236588;
            else if(s=='m') l=parseFloat(e.m.value)*1000;
            else if(s=='ft') l=parseFloat(e.ft.value)*28.3168;

            if(!isNaN(l)){
                if(s!='l') e.l.value=fmt(l);
                if(s!='ml') e.ml.value=fmt(l*1000);
                if(s!='gal') e.gal.value=fmt(l/3.78541);
                if(s!='cp') e.cp.value=fmt(l/0.236588);
                if(s!='m') e.m.value=fmt(l/1000);
                if(s!='ft') e.ft.value=fmt(l/28.3168);
            }
        }

        function cWei(s) {
            let k=0, e={kg:get('w_kg'), lb:get('w_lb'), g:get('w_g'), oz:get('w_oz'), t:get('w_t')};
            if(s=='kg') k=parseFloat(e.kg.value);
            else if(s=='lb') k=parseFloat(e.lb.value)*0.453592;
            else if(s=='g') k=parseFloat(e.g.value)/1000;
            else if(s=='oz') k=parseFloat(e.oz.value)*0.0283495;
            else if(s=='t') k=parseFloat(e.t.value)*1000;

            if(!isNaN(k)){
                if(s!='kg') e.kg.value=fmt(k);
                if(s!='lb') e.lb.value=fmt(k/0.453592);
                if(s!='g') e.g.value=fmt(k*1000);
                if(s!='oz') e.oz.value=fmt(k/0.0283495);
                if(s!='t') e.t.value=fmt(k/1000);
            }
        }

        function cTem(s) {
            let c=get('b_c'), f=get('b_f'), k=get('b_k');
            if(s=='c'){ let v=parseFloat(c.value); f.value=fmt((v*1.8)+32); k.value=fmt(v+273.15); }
            if(s=='f'){ let v=parseFloat(f.value); c.value=fmt((v-32)/1.8); k.value=fmt(((v-32)/1.8)+273.15); }
            if(s=='k'){ let v=parseFloat(k.value); c.value=fmt(v-273.15); f.value=fmt(((v-273.15)*1.8)+32); }
        }

        function cSpd(s) {
            let k=get('b_km'), m=get('b_mi');
            if(s=='km') m.value=fmt(parseFloat(k.value)/1.60934);
            if(s=='mi') k.value=fmt(parseFloat(m.value)*1.60934);
        }

        // CALC
        let cVal = "0";
        function calc(v) {
            vib(15);
            let scr = document.getElementById("calc-res");
            let his = document.getElementById("calc-hist");
            
            if(v=='AC') { cVal="0"; his.innerText=""; }
            else if(v=='DEL') { cVal = cVal.length > 1 ? cVal.slice(0, -1) : "0"; }
            else if(v=='=') {
                try {
                    let res = Function('"use strict";return (' + cVal.replace('x','*').replace('%','/100') + ')')();
                    his.innerText = cVal + " =";
                    cVal = String(fmt(res));
                } catch { cVal = "Error"; }
            } else {
                if(cVal==="0" || cVal==="Error") cVal = v;
                else cVal += v;
            }
            scr.value = cVal;
        }

        function get(id) { return document.getElementById(id); }
        function vib(ms=8) { if(navigator.vibrate) navigator.vibrate(ms); }
    </script>
</body>
</html>